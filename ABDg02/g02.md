author: Christian Paz
summary: Guía de aprendizaje 02
id: g02
categories: Databases
environments: Databases
status: Published
feedback link: mailto:e

# Gestión de usuarios y administración de permisos en SQL Server

## Introduccion

En la administración de bases de datos, una de las tareas fundamentales es gestionar los
usuarios y controlar los permisos que poseen sobre los objetos del sistema. Una
configuración adecuada garantiza la seguridad, la integridad de los datos y la correcta
operación de las aplicaciones que acceden al sistema.

Por ello es importante conocer los siguientes puntos:

## Diferencia entre inicio de sesión (Login) y usuario de base de datos

En SQL Server, aunque están relacionados, **login** y **usuario** no son lo mismo:

- **Login (inicio de sesión):** Es la credencial de acceso al motor de base de datos. Se
crea a nivel del servidor y permite autenticar a una persona o aplicación.
Ejemplo: 

```sql
CREATE LOGIN orange WITH PASSWORD = 'P@ssw0rd!2025'.
```

- **Usuario de base de datos:** Es la identidad dentro de una base de datos específica
que se asocia a un login. Permite que un inicio de sesión tenga acceso a una base
de datos en particular. Ejemplo:

```sql
CREATE USER orange FOR LOGIN orange.
```

<aside class="warning">
Un login puede existir sin tener usuario en una base de datos, pero un usuario siempre
necesita estar asociado a un login para poder acceder.
</aside>

## Principio de mínimo privilegio

La seguridad por mínimo privilegio indica que un usuario o aplicación debe contar
únicamente con los permisos necesarios para realizar sus tareas y nada más.
Esto disminuye riesgos de:

- Accesos no autorizados.
- Pérdida o corrupción de datos.
- Escalamiento indebido de privilegios.

## Roles en SQL Server

En lugar de asignar permisos directamente a cada usuario, SQL Server recomienda el uso de roles. Un rol es un contenedor de permisos que facilita la administración:

- **Roles de servidor:** Definen permisos a nivel global (ejemplo de ello es el:
sysadmin).

- **Roles de base de datos:** Controlan permisos dentro de una base de datos
específica.

Asignar usuarios a roles en lugar de manejar permisos individuales simplifica la gestión y
mejora la seguridad.

Ejemplos:

- Un rol de solo lectura que permite ejecutar únicamente consultas SELECT.
- Un rol de aplicación que permite realizar operaciones de lectura, inserción y actualización sobre ciertas tablas, pero niega operaciones riesgosas como DELETE o
ALTER.

## Administración de permisos

Los permisos en SQL Server se pueden otorgar o restringir de diferentes maneras:

- **GRANT:** Concede permisos sobre objetos (ej. GRANT SELECT)
- **DENY:** Niega permisos explícitamente, incluso si el rol tiene permisos concedidos.
- **REVOKE:** Revoca permisos previamente otorgados o denegados.

Un diseño seguro incluye defensa en profundidad, combinando permisos mínimos con
denegaciones explícitas de operaciones peligrosas.

## Comprobación de permisos

Para verificar los permisos de un usuario se pueden usar mecanismos como:

- EXECUTE AS USER: simula que se está operando como un usuario específico
- fn_my_permissions: función que muestra los permisos efectivos que un usuario posee en un contexto determinado.

## Buenas practicas de seguridad

1. **Contraseñas seguras**:
 - Uso de mayúsculas, minúsculas, números y caracteres especiales.
 - Políticas de expiración y rotación periódica.
2. **Principio de menor privilegio:**
 - Nunca otorgar permisos amplios a menos que sea estrictamente necesario
3. **Uso de roles:**
 - Evitar permisos directos sobre cada usuario.
 - Crear roles específicos para distintos perfiles de uso (ej. lectura, carga de datos,
administración).
4. **Defensa en profundidad:**
 - Permisos mínimos combinados con denegaciones explícitas.
5. **Supervisión de cuentas privilegiadas:**
 - El rol sysadmin debe reservarse para administradores de bases de datos.
 - Nunca usar sa o sysadmin en conexiones de aplicaciones.
6. **Auditoría y monitoreo:**
 - Habilitar auditoría de inicios de sesión fallidos.
 - Revisar regularmente permisos y roles asignados.

## Ejercicio

Siga las instrucciones del instructor encargado para el desarrollo de la guia de trabajo relacionada a creacion de logins, usuarios y su administracion.

## Créditos

Departamento de Electrónica e Informática, Universidad Centroamericana José Simeón Cañas, La Libertad, El Salvador.

**Versión de este documento:** Versión 5, 2025.

| **Versión**  | **Autores** |
|----------|----------|
| **1** | Christian Alejandro Paz Escobar (00132720@uca.edu.sv), Claudia Maria Chavez Grande (00037221@uca.edu.sv) |

![license](./license.jpg) This work is licensed under a [Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License](http://creativecommons.org/licenses/by-nc-sa/4.0/).